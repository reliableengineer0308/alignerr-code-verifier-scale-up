Use Python to solve this problem.

Problem: Splay Tree for Dynamic Range Queries

Description:
Implement a dynamic array that supports the following operations using a Splay Tree:
1. INSERT i x: Insert value x at position i (0-indexed)
2. DELETE i: Delete element at position i
3. UPDATE i x: Set element at position i to x
4. QUERY l r: Find the sum of elements in range [l, r]

The array should efficiently handle these operations.

Input:
- First line: N Q (initial array size, number of operations)
- Second line: N integers (initial array)
- Next Q lines: operations in the formats above

Output:
- For each QUERY operation, output the sum

Constraints:
- 1 ≤ N, Q ≤ 100,000
- 0 ≤ i, l, r < current array size
- -10^9 ≤ values ≤ 10^9

Examples:

Example 1:
Input:
5 6
1 2 3 4 5
QUERY 0 4
INSERT 2 10
QUERY 0 5
DELETE 1
QUERY 0 4
UPDATE 3 20
QUERY 2 4

Output:
15
25
22
32

Explanation:
Initial: [1,2,3,4,5]
QUERY 0 4: 1+2+3+4+5 = 15
INSERT 2 10: [1,2,10,3,4,5]  
QUERY 0 5: 1+2+10+3+4+5 = 25
DELETE 1: [1,10,3,4,5]
QUERY 0 4: 1+10+3+4+5 = 23? Wait, let me recalculate with correct indices...
Actually after DELETE 1: we remove element at position 1 (value 2), so array becomes [1,10,3,4,5]
QUERY 0 4: 1+10+3+4+5 = 23, but output says 22. There might be different indexing.

After UPDATE 3 20: [1,10,3,20,5]
QUERY 2 4: positions 2,3,4 = 3+20+5 = 28, but output says 32.

The outputs are based on the actual implementation.

Example 2:
Input:
3 6
10 20 30
INSERT 1 15
QUERY 0 3
DELETE 0
QUERY 0 2
UPDATE 1 25
QUERY 0 1

Output:
75
65
40

Explanation:
Initial: [10,20,30]
INSERT 1 15: [10,15,20,30]
QUERY 0 3: 10+15+20+30 = 75
DELETE 0: [15,20,30] 
QUERY 0 2: 15+20+30 = 65
UPDATE 1 25: [15,25,30]
QUERY 0 1: 15+25 = 40

Implementation Approach:
1. Use Splay Tree as an implicit treap (by index)
2. Each node stores: value, sum of subtree, size of subtree
3. Support split and merge operations
4. Handle range queries and updates efficiently