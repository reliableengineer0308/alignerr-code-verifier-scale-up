Use Python to solve this problem.

Problem: Dominator Tree in Directed Graph

Description:
Given a directed graph with N nodes and M edges, find the dominator tree starting from node 0.

Definitions:
1. A node u dominates node v if every path from start node 0 to v must go through u.
2. The immediate dominator of v is the unique node u ≠ v that dominates v and is dominated by every dominator of v except itself.
3. The dominator tree has an edge from u to v if u is the immediate dominator of v.

Key Properties:
- Node 0 dominates all reachable nodes (since all paths start from 0)
- The immediate dominator of node 0 is itself
- If v is unreachable from node 0, it has no dominator
- The dominator tree forms a tree rooted at node 0

Input:
- First line: T (number of test cases)
- For each test case:
  - First line: N M (nodes, edges)
  - Next M lines: u v (directed edge from u to v, 0-indexed)

Output:
- For each test case:
  - First line: "Case #X:" where X is test case number
  - Next N lines: for each node i, output its immediate dominator
    - For node 0, output itself (0)
    - For unreachable nodes, output -1

Constraints:
- 1 ≤ N ≤ 100,000
- 1 ≤ M ≤ 200,000
- 0 ≤ u, v < N

Example 1 - Simple Dominator Chain:
Input:
1
4 3
0 1
1 2
2 3

Output:
Case #1:
0
0
1
2

Explanation:
- Node 0: starting node, immediate dominator is itself
- Node 1: all paths to 1 go through 0 → immediate dominator is 0
- Node 2: all paths to 2 go through 0 and 1, but 1 is closer → immediate dominator is 1
- Node 3: all paths to 3 go through 0,1,2, but 2 is closest → immediate dominator is 2

Example 2 - Complex Graph with Multiple Paths:
Input:
1
7 10
0 1
0 2
1 3
2 3
3 4
3 5
4 6
5 6
1 4
2 5

Output:
Case #1:
0
0
0
0
3
3
3

Explanation:
- Node 0: starting node
- Node 1,2: dominated only by 0
- Node 3: all paths to 3 go through 0,1,2 but 0 is the immediate dominator
- Node 4: paths: 0→1→3→4, 0→2→3→4, 0→1→4. 
  All paths go through 0 and 3, but 0→1→4 bypasses 3? Wait, let's check carefully...
  Actually: 0→1→4 goes directly without going through 3, so 3 is NOT a dominator of 4.
  Correction: The output shows 3 as immediate dominator, meaning the graph might be different.

Example 3 - True Complex Graph:
Input:
1
6 7
0 1
0 2
1 3
2 3
3 4
3 5
4 5

Output:
Case #1:
0
0
0
0
3
3

Explanation:
- Node 4: paths are 0→1→3→4 and 0→2→3→4 (both go through 3)
- Node 5: paths are 0→1→3→4→5, 0→2→3→4→5, 0→1→3→5, 0→2→3→5 (all go through 3)
- Therefore, node 3 dominates both 4 and 5

Example 4 - Diamond Pattern with Bypass:
Input:
1
5 5
0 1
0 2
1 3
2 3
1 4

Output:
Case #1:
0
0
0
0
1

Explanation:
- Node 4: paths are 0→1→3→4 and 0→1→4
- All paths go through 0 and 1, but not all go through 3
- Therefore, immediate dominator is 1

Example 5 - Unreachable Nodes:
Input:
1
5 4
0 1
0 2
1 3
2 4

Output:
Case #1:
0
0
0
1
2

Explanation:
- Node 3: only path is 0→1→3 → immediate dominator is 1
- Node 4: only path is 0→2→4 → immediate dominator is 2

Algorithm Requirements:
- Implement Lengauer-Tarjan algorithm for dominator tree
- Use DFS for depth-first numbering
- Compute semidominators and immediate dominators
- Handle large graphs efficiently
- O((N+M) log N) or O(N+M) time complexity

Implementation Steps:
1. Perform DFS from node 0 to assign depth-first numbers
2. Process nodes in reverse DFS order to compute semidominators
3. Use union-find with path compression to efficiently find minimum semidominators
4. Compute immediate dominators from semidominators
5. Handle unreachable nodes appropriately