import unittest
from solution import is_valid_sudoku

class TestValidSudoku(unittest.TestCase):
    
    def test_valid_classic_board(self):
        board = [
            ["5","3",".",".","7",".",".",".","."],
            ["6",".",".","1","9","5",".",".","."],
            [".","9","8",".",".",".",".","6","."],
            ["8",".",".",".","6",".",".",".","3"],
            ["4",".",".","8",".","3",".",".","1"],
            ["7",".",".",".","2",".",".",".","6"],
            [".","6",".",".",".",".","2","8","."],
            [".",".",".","4","1","9",".",".","5"],
            [".",".",".",".","8",".",".","7","9"]
        ]
        self.assertTrue(is_valid_sudoku(board))
    
    def test_invalid_row_duplicate(self):
        board = [
            ["5","3",".",".","7",".",".",".","."],
            ["6",".",".","1","9","5",".",".","."],
            [".","9","8",".",".",".",".","6","."],
            ["8",".",".",".","6",".",".",".","3"],
            ["4",".",".","8",".","3",".",".","1"],
            ["7",".",".",".","2",".",".",".","6"],
            [".","6",".",".",".",".","2","8","."],
            [".",".",".","4","1","9",".",".","5"],
            [".",".",".",".","8",".","7","7","9"]  # Duplicate 7 in last row
        ]
        self.assertFalse(is_valid_sudoku(board))
    
    def test_invalid_subbox_duplicate(self):
        board = [
            ["5","3",".",".","7",".",".",".","."],
            ["6",".",".","1","9","5",".",".","."],
            [".","9","8",".",".",".",".","6","."],
            ["8",".",".",".","6",".",".",".","3"],
            ["4",".",".","8",".","3",".",".","1"],
            ["7",".",".",".","2",".",".",".","6"],
            [".","6",".",".",".",".","2","8","."],
            [".",".",".","4","1","9",".",".","5"],
            [".",".",".",".","8","7",".","7","9"]  # Duplicate 7 in bottom-right sub-box
        ]
        self.assertFalse(is_valid_sudoku(board))
    
    def test_valid_complex_board(self):
        board = [
            [".","6",".","9",".",".","2",".","."],
            [".",".","7",".",".",".","6",".","4"],
            ["4",".","3",".","8",".",".","7","."],
            [".","7",".","1",".","5",".","3","."],
            ["9",".",".",".",".",".",".",".","1"],
            [".","2",".","6",".","9",".","8","."],
            [".","1",".",".","5",".","4",".","9"],
            ["5",".","8",".",".",".","3",".","."],
            [".",".","4",".",".","1",".","7","."]
        ]
        self.assertFalse(is_valid_sudoku(board))
    
    def test_empty_board(self):
        board = [["."]*9 for _ in range(9)]
        self.assertTrue(is_valid_sudoku(board))
    
    def test_invalid_column_duplicate(self):
        board = [
            ["5","3",".",".","7",".",".",".","."],
            ["6",".",".","1","9","5",".",".","."],
            ["5","9","8",".",".",".",".","6","."],  # Duplicate 5 in first column
            ["8",".",".",".","6",".",".",".","3"],
            ["4",".",".","8",".","3",".",".","1"],
            ["7",".",".",".","2",".",".",".","6"],
            [".","6",".",".",".",".","2","8","."],
            [".",".",".","4","1","9",".",".","5"],
            [".",".",".",".","8",".",".","7","9"]
        ]
        self.assertFalse(is_valid_sudoku(board))

if __name__ == '__main__':
    unittest.main()