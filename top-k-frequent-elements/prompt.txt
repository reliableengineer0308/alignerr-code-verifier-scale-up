Problem: Top K Frequent Elements

Description:
Implement a function top_k_frequent(nums, k) that returns the k most frequent elements in an array. The answer can be returned in any order.

Your task:
- Count frequency of each element in the input list
- Return k elements with highest frequencies
- If multiple elements have same frequency, any valid combination is acceptable
- Optimize for performance with large inputs

Input:
List nums: array of integers, 1 ≤ len(nums) ≤ 10⁴
Integer k: number of top frequent elements to return, 1 ≤ k ≤ number of unique elements
Element range: −10^4 ≤nums[i]≤10^4

Output:
- List of k integers with highest frequencies
- Order of elements in result doesn’t matter

Examples:
Example 1:
Input: nums = [1,1,1,2,2,3], k = 2
Output: [1,2]
Explanation: 1 appears 3 times, 2 appears 2 times, 3 appears 1 time. Top 2 frequent are [1,2].

Example 2:
Input: nums = [1], k = 1
Output: [1]

Example 3:
Input: nums = [4,1,-1,2,-1,2,3], k = 2
Output: [-1,2] (or [2,-1])
Explanation: -1 and 2 both appear twice.

Constraints:
1≤len(nums)≤10^4
1≤k≤number of unique elements
Time complexity: O(n+klogn) or better
Space complexity: O(n)
Avoid O(n^2) solutions for large inputs

Notes:
- Use hash map (dictionary) to count frequencies
- Use heap or sorting to get top k elements
- Consider edge cases: single element, all elements same frequency
- For equal frequencies, any valid k elements are acceptable